{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}

<div class="container stats">

    <h1>Réservations</h1>

    {% crispy filter.form %}

    <table class="table table-striped table-hover booking-stats">
        <tr>
            <th></th>
            <th class="text-right">CA</th>
            <th class="text-right">%</th>
            <th class="text-right">Nuitées</th>
            <th class="text-right">%</th>
            <th class="text-right">prix</th>
            <th class="text-right">Effectifs</th>
        </tr>
        <tr>
            <th>Terrain</th>
            <td class="text-right">{{ stats_terrain.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_terrain.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_terrain.overnights }}</td>
            <td class="text-right">{{ stats_terrain.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_terrain.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_terrain.headcount }}</td>
        </tr>
        <tr>
            <th>Village</th>
            <td class="text-right">{{ stats_village.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_village.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_village.overnights }}</td>
            <td class="text-right">{{ stats_village.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_village.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_village.headcount }}</td>
        </tr>
        <tr>
            <th>1er trimestre</th>
            <td class="text-right">{{ stats_q1.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_q1.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q1.overnights }}</td>
            <td class="text-right">{{ stats_q1.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q1.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_q1.headcount }}</td>
        </tr>
        <tr>
            <th>2ème trimestre</th>
            <td class="text-right">{{ stats_q2.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_q2.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q2.overnights }}</td>
            <td class="text-right">{{ stats_q2.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q2.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_q2.headcount }}</td>
        </tr>
        <tr>
            <th>3ème trimestre</th>
            <td class="text-right">{{ stats_q3.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_q3.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q3.overnights }}</td>
            <td class="text-right">{{ stats_q3.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q3.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_q3.headcount }}</td>
        </tr>
        <tr>
            <th>4ème trimestre</th>
            <td class="text-right">{{ stats_q4.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right">{{ stats_q4.amount_hosting_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q4.overnights }}</td>
            <td class="text-right">{{ stats_q4.overnights_rate|floatformat:"0" }} %</td>
            <td class="text-right">{{ stats_q4.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats_q4.headcount }}</td>
        </tr>
        <tr>
            <th>Hébergement</th>
            <td class="text-right">{{ stats.amount_hosting|floatformat:"0" }} €</td>
            <td class="text-right"></td>
            <td class="text-right">{{ stats.overnights }}</td>
            <td class="text-right"></td>
            <td class="text-right">{{ stats.overnight_cost|floatformat:"2" }} €</td>
            <td class="text-right">{{ stats.headcount }}</td>
        </tr>
        <tr>
            <th>Contrat de coopération</th>
            <td class="text-right">{{ stats.amount_cot|floatformat:"0" }} €</td>
            <td class="text-right"></td>
            <td class="text-right">{{ stats.overnights_cot }}</td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right">{{ stats.headcount_cot }}</td>
        </tr>
        <tr>
            <th>Location matériel</th>
            <td class="text-right">{{ stats.amount_renting|floatformat:"0" }} €</td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
        </tr>
        <tr>
            <th>Refacturation</th>
            <td class="text-right">{{ stats.amount_recharge|floatformat:"0" }} €</td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
        </tr>
        <tr>
            <th>Total</th>
            <td class="text-right">{{ stats.amount|floatformat:"0" }} €</td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right"></td>
            <td class="text-right">{{ stats.headcount }}</td>
        </tr>
    </table>

{% endblock content %}


{% block js %}

    {{ block.super }}

    <script>
        $('select, :checkbox').change(function() {$('form').submit()});
    </script>

{% endblock js %}
